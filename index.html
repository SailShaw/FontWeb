<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
    <title>校园活动系统</title>

    <!-- General CSS Files -->
    <link rel="stylesheet" href="modules/css/bootstrap.min.css">
    <link rel="stylesheet" href="modules/css/all.min.css">
    <link rel="stylesheet" href="modules/css/jqvmap.min.css">
    <link rel="stylesheet" href="modules/summernote/summernote-bs4.css">
    <link rel="stylesheet" href="modules/css/owl.carousel.min.css">
    <link rel="stylesheet" href="modules/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="modules/css/style.css">
    <link rel="stylesheet" href="modules/css/components.css">
    <link rel="stylesheet" href="modules/css/notyf.min.css">
    <!-- Start GA -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-94034622-3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-94034622-3');
    </script>
    <!-- /END GA --></head>

<body>
<div id="app">
    <div class="main-wrapper main-wrapper-1">
        <div class="navbar-bg"></div>
        <!--Nav :-->
        <nav class="navbar navbar-expand-lg main-navbar">
            <form class="form-inline mr-auto">
                <ul class="navbar-nav mr-3">
                    <li><a href="#" data-toggle="sidebar" class="nav-link nav-link-lg"><i class="fas fa-bars"></i></a>
                    </li>
                </ul>

            </form>
            <!-- 右上角 -->
            <ul class="navbar-nav navbar-right">
                <!-- 头像部分 -->
                <li class="dropdown"><a href="#" data-toggle="dropdown"
                                        class="nav-link dropdown-toggle nav-link-lg nav-link-user">
                    <img alt="image" src="modules/img/avatar/avatar-1.png" class="rounded-circle mr-1">
                    <div class="d-sm-none d-lg-inline-block">Hi,<span id="current_znName"></span></div>
                </a>
                    <!-- 弹框 -->
                    <div class="dropdown-menu dropdown-menu-right">
                        <!--上次登录时间-->
                        <div style="text-align: center" class="dropdown-title"><strong>上次登录:<span id="current_lastLogin"></span></strong>
                        </div>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item has-icon">
                            <i class="fas fa-calendar"></i> 个人中心
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item has-icon">
                            <i class="fas fa-sign-out-alt"></i>退出系统
                        </a>
                    </div>
                </li>
            </ul>
        </nav>
        <!--: Nav -->

        <!--Sidebar:-->
        <div class="main-sidebar sidebar-style-2">
            <aside id="sidebar-wrapper">
                <div class="sidebar-brand">
                    <a href="index.html">
                        <small>校内活动管理系统</small>
                    </a>
                </div>
                <div class="sidebar-brand sidebar-brand-sm">
                    <a href="index.html">CAMS</a>
                </div>
                <ul class="sidebar-menu" id="menu">

                    <li class="menu-header">Dashboard</li>
                    <li class="active">
                        <a class="nav-link" href="index.html"><i class="fas fa-tachometer-alt"></i><span>首&#12288;&#12288;页</span></a>
                    </li>

                    <li class="menu-header">Person Center</li>

                    <li>
                        <a class="nav-link" href="personal-center.html"><i class="fas fa-user"></i><span>个人中心</span></a>
                    </li>


                    <li class="menu-header">Activity Center</li>
                    <li>
                        <a class="nav-link" href="activity-center.html"><i class="fab fa-centercode"></i><span>活动中心</span></a>
                    </li>
                    <li>
                        <a class="nav-link" href="review-center.html"><i class="fab fa-typo3"></i><span>审核管理</span></a>
                    </li>

                    <li class="menu-header">System Management</li>
                    <li>
                        <a class="nav-link" href="users-center.html"><i class="fas fa-users"></i><span>用户管理</span></a>
                    </li>
                    <li>
                        <a class="nav-link" href="email-test.html"><i class="fas fa-envelope"></i><span>邮箱测试</span></a>
                    </li>
                    <li>
                        <a class="nav-link" href="place-center.html"><i class="fas fa-map-signs"></i><span>资源管理</span></a>
                    </li>
                    <li>
                        <a class="nav-link" href="system-log.html"><i class="fas fa-tags"></i><span>系统日志</span></a>
                    </li>
                </ul>
            </aside>
        </div>
        <!--:Sidebar-->
        <!-- Main Content -->
        <div class="main-content">
            <section class="section">
                <div class="row">
                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <div class="card card-statistic-2">
                            <div class="card-stats">
                                <div class="card-stats-title">数据统计
                                    <!--<div class="dropdown d-inline">
                                        <a class="font-weight-600 dropdown-toggle" data-toggle="dropdown" href="#"
                                           id="orders-month">August</a>
                                        <ul class="dropdown-menu dropdown-menu-sm">
                                            <li class="dropdown-title">Select Month</li>
                                            <li><a href="#" class="dropdown-item">January</a></li>
                                            <li><a href="#" class="dropdown-item">February</a></li>
                                            <li><a href="#" class="dropdown-item">March</a></li>
                                            <li><a href="#" class="dropdown-item">April</a></li>
                                            <li><a href="#" class="dropdown-item">May</a></li>
                                            <li><a href="#" class="dropdown-item">June</a></li>
                                            <li><a href="#" class="dropdown-item">July</a></li>
                                            <li><a href="#" class="dropdown-item active">August</a></li>
                                            <li><a href="#" class="dropdown-item">September</a></li>
                                            <li><a href="#" class="dropdown-item">October</a></li>
                                            <li><a href="#" class="dropdown-item">November</a></li>
                                            <li><a href="#" class="dropdown-item">December</a></li>
                                        </ul>
                                    </div>-->
                                </div>
                                <div class="card-stats-items">
                                    <div class="card-stats-item">
                                        <div class="card-stats-item-count" id="pending"></div>
                                        <div class="card-stats-item-label">待审核</div>
                                    </div>
                                    <div class="card-stats-item">
                                        <div class="card-stats-item-count" id="passed"></div>
                                        <div class="card-stats-item-label">已通过</div>
                                    </div>
                                    <div class="card-stats-item">
                                        <div class="card-stats-item-count" id="noPassed"></div>
                                        <div class="card-stats-item-label">未通过</div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-icon shadow-primary bg-primary">
                                <i class="fas fa-archive"></i>
                            </div>
                            <div class="card-wrap">
                                <div class="card-header">
                                    <strong>活动申请总数</strong>
                                </div>
                                <div class="card-body" id="applicationTotal">

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <div class="card card-statistic-2">
                            <div class="card-chart">
                                <canvas id="balance-chart" height="80"></canvas>
                            </div>
                            <div class="card-icon shadow-primary bg-primary">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="card-wrap">
                                <div class="card-header">
                                    <strong>已注册用户总数</strong>
                                </div>
                                <div class="card-body" id="userCount">

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <div class="card card-statistic-2">
                            <div class="card-chart">
                                <canvas id="sales-chart" height="80"></canvas>
                            </div>
                            <div class="card-icon shadow-primary bg-primary">
                                <i class="fas fa-shopping-bag"></i>
                            </div>
                            <div class="card-wrap">
                                <div class="card-header">
                                    <strong>资源总数</strong>
                                </div>
                                <div class="card-body" id="placeCount">

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-header">
                                <h4>上一周活动申请提交统计</h4>
                            </div>
                            <div class="card-body">
                                <canvas id="myChart" height="132"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <!--todo:-->
                        <div class="card card-hero">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="far fa-question-circle"></i>
                                </div>
                                <h4>14</h4>
                                <div class="card-description"><smal>两周内新提交的申请表</smal></div>
                            </div>
                            <div class="card-body p-0">
                                <div class="tickets-list" id="twoWeekData">
                                </div>
                            </div>
                        </div>
                        <!--:todo-->
                    </div>
                </div>
            </section>
        </div>
        <footer class="main-footer">
            <div class="footer-left">
                Copyright &copy; 2018
                <div class="bullet"></div>
                Design By <a href="https://nauval.in/">Muhamad Nauval Azhar</a>
            </div>
            <div class="footer-right">

            </div>
        </footer>
    </div>
</div>

<!-- General JS Scripts -->
<script src="modules/js/jquery.min.js"></script>
<script src="modules/js/popper.js"></script>
<script src="modules/js/tooltip.js"></script>
<script src="modules/js/notyf.min.js"></script>
<script src="modules/js/bootstrap.min.js"></script>
<script src="modules/js/jquery.nicescroll.min.js"></script>
<script src="modules/js/moment.min.js"></script>
<script src="modules/js/stisla.js"></script>
<script src="modules/js/jquery.sparkline.min.js"></script>
<script src="modules/js/chart.min.js"></script>
<script src="modules/js/owl.carousel.min.js"></script>
<script src="modules/summernote/summernote-bs4.js"></script>
<script src="modules/js/jquery.chocolat.min.js"></script>
<script src="modules/js/index.js"></script>
<script src="modules/js/scripts.js"></script>
<script src="modules/js/custom.js"></script>
<script type="text/javascript">
    var ctx = document.getElementById("myChart").getContext('2d');
    var Json = {};
    $(function () {
        navInfo();

        $.ajax({
            url:BaseUrl + '/global/dataStatistics',
            type: 'get',
            dataType: 'json',
            //解决session不共享
            crossDomain: true,
            xhrFields: {withCredentials: true},
            success: function (data) {
                $.each(data,function (key,val) {
                    switch (key) {
                        case "total":
                            $("#applicationTotal").html(val);
                            break;
                        case "typeCount":
                            for (var i in val) {
                                switch (i) {
                                    case "0":
                                        $("#pending").html(val[i].total);
                                        break;
                                    case "1":
                                        $("#passed").html(val[i].total);
                                        break;
                                    default:
                                        $("#noPassed").html(val[i].total);
                                        break;
                                }
                            }
                            break;
                        case "userCount":
                            $("#userCount").html(val);
                            break;
                        case "placeCount":
                            $("#placeCount").html(val);
                            break;
                        case "twoWeekDataCount":
                            for (var i in val) {
                                $("#twoWeekData").append(
                                    "<a href='#' class='ticket-item'>" +
                                    "<div class='ticket-title'>" +
                                    "<h4>"+val[i].activityTitle+"</h4>" +
                                    "</div>" +
                                    "<div class='ticket-info'>" +
                                    "<div>"+val[i].znname+"</div>" +
                                    "<div class='bullet'></div>" +
                                    "<div class='text-primary'>"+val[i].createTime+"</div>" +
                                    "</div>" +
                                    "</a>");
                            }
                            $("#twoWeekData").append(
                                "<a href='activity-center.html' class='ticket-item ticket-more'>" +
                                "View All<i class='fas fa-chevron-right'></i></a>");
                            break;
                        case "lastWeekNumCount":
                            xData = new Array();
                            yData = new Array();
                            for (var i in val) {
                                xData.push(val[i].weekDay);
                                yData.push(val[i].countNum);
                            }
                            var myChart = new Chart(ctx, {
                                type: 'line',
                                data: {
                                    labels: xData,
                                    datasets: [{
                                        label: '当天提交数',
                                        data: yData,
                                        // borderWidth: 2,
                                        backgroundColor: 'rgba(63,82,227,.8)',
                                        borderWidth: 0,
                                        borderColor: 'transparent',
                                        pointBorderWidth: 5,
                                        pointRadius: 5,
                                        pointColor: "rgba(220,220,220,1)",
                                        // pointBackgroundColor: 'transparent',
                                        pointHoverBackgroundColor: 'rgba(63,82,227,.8)',
                                    }
                                    ]
                                },
                                options: {
                                    legend: {
                                        display: false
                                    },
                                    scales: {
                                        yAxes: [{
                                            gridLines: {
                                                // display: false,
                                                drawBorder: false,
                                                color: '#f2f2f2',
                                            },
                                            ticks: {
                                                beginAtZero: true,
                                                stepSize: 10,
                                                callback: function(value, index, values) {
                                                    return '$' + value;
                                                }
                                            }
                                        }],
                                        xAxes: [{
                                            gridLines: {
                                                display: false,
                                                tickMarkLength: 15,
                                            }
                                        }]
                                    },
                                }
                            });
                            break;


                    }
                })
            }
        })
    })
</script>
</body>
</html>